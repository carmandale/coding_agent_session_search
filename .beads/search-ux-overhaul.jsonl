{"id":"coding_agent_session_search-sux","title":"Search UX Overhaul Epic","description":"Comprehensive improvements to search flow: indexing status clarity, query history debouncing, wildcard support, implicit wildcards, smarter ranking, and enhanced result display with more context, highlighting, alternating stripes, toggleable borders, and better detail pane.","notes":"This epic addresses six major areas:\n\n1. **Indexing Status Clarity** - Users need to know when search is degraded during initial/background indexing\n2. **Query History Debouncing** - Currently saves 'f','fo','foo' etc separately; need to only save final queries\n3. **Wildcard Support** - Full asterisk wildcard support (*foo, foo*, *foo*)\n4. **Implicit Wildcards** - Auto-add wildcards when results are sparse\n5. **Smarter Ranking** - Recency + match quality (exact > suffix wildcard > prefix wildcard > both)\n6. **Enhanced Display** - 6-8 lines context, bold highlighted matches, alternating stripes, unicode borders, better detail pane\n\nContext from codebase analysis:\n- tui.rs:3382-3389 saves query history after EVERY debounced search (60ms), not after user stops typing\n- query.rs sanitize_query() currently strips non-alphanumeric chars including asterisks\n- Ranking in tui.rs:3321-3338 uses Tantivy score + recency boost but no match quality factor\n- Current result display is 2 lines per item (header + location/snippet)\n- Indexing progress shown in footer but doesn't clearly indicate search degradation","status":"open","priority":1,"issue_type":"epic","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z"}
{"id":"coding_agent_session_search-sux.1","title":"A1: Indexing Status Clarity","description":"Epic for making indexing status more visible and informative to users during initial or background indexing.","notes":"**Problem**: During initial indexing or rebuilds, search results may be incomplete or empty. Users need clear indication that:\n1. Indexing is in progress\n2. Search results may be degraded until complete\n3. Estimated time/progress to completion\n\n**Current State** (tui.rs:1608-1632):\n- Footer shows 'Scanning X/Y (Z%)' or 'Indexing X/Y (Z%)'\n- '[REBUILDING INDEX - Search unavailable]' shown during full rebuilds\n- '[Updating]' shown during incremental updates\n\n**Improvements Needed**:\n- More prominent visual indicator (not just footer text)\n- Clearer messaging about search impact\n- Progress bar or spinner in results area when empty due to indexing\n- Consider showing partial results with warning banner","status":"open","priority":1,"issue_type":"epic","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.1","depends_on_id":"coding_agent_session_search-sux","type":"child_of","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.1.1","title":"A1.1: Indexing status banner in results area","description":"Display a prominent banner in the results area when indexing is in progress, with progress bar and estimated completion.","notes":"**Implementation**:\n1. In tui.rs render loop (around line 1706-1742), when panes.is_empty() AND progress.phase != 0:\n   - Show dedicated indexing banner instead of 'No results'\n   - Include spinner animation (reuse SPINNER_CHARS)\n   - Show progress bar using indicatif-style blocks\n   - Display phase name ('Scanning sources...' / 'Building index...')\n   - Add helpful text: 'Search will be available once indexing completes'\n\n2. When panes are NOT empty but indexing is in progress:\n   - Add subtle banner at top of results: 'âš  Indexing in progress - results may be incomplete'\n   - Use warning color from palette (amber/yellow)\n\n**Files to modify**:\n- src/ui/tui.rs: render logic for results area\n- src/ui/components/widgets.rs: optional new widget for progress banner\n\n**Testing**:\n- Verify banner appears during cass index --full\n- Verify banner clears when indexing completes\n- Test with TUI_HEADLESS=1 for snapshot","status":"open","priority":1,"issue_type":"task","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.1.1","depends_on_id":"coding_agent_session_search-sux.1","type":"child_of","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.1.2","title":"A1.2: Footer indexing indicator enhancement","description":"Enhance footer to show more descriptive indexing status with phase-specific icons and clearer messaging.","notes":"**Current** (tui.rs:1608-1632):\n```rust\nlet phase_str = if phase == 1 { \"Scanning\" } else { \"Indexing\" };\ns.push_str(\" [REBUILDING INDEX - Search unavailable]\");\n```\n\n**Improvements**:\n1. Add phase-specific icons: ğŸ” Scanning | ğŸ“¦ Indexing | âœ“ Ready\n2. Show ETA if possible (based on rate of current/total change)\n3. Clearer impact messaging:\n   - Phase 1 (Scanning): 'ğŸ” Discovering sessions...' \n   - Phase 2 (Indexing): 'ğŸ“¦ Building search index...'\n   - Rebuilding: 'âš  Full rebuild - search unavailable'\n4. Flash or pulse the indicator to draw attention\n\n**Files to modify**:\n- src/ui/tui.rs: render_progress closure (line 1608)\n\n**Testing**:\n- Verify correct icons per phase\n- Test transitions between phases","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.1.2","depends_on_id":"coding_agent_session_search-sux.1","type":"child_of","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.1.3","title":"A1.3: Partial results with degraded warning","description":"When indexing is in progress but some results exist, show them with a visible warning that results may be incomplete.","notes":"**Rationale**: During incremental updates or early in initial indexing, there may be partial results. Better to show these than nothing.\n\n**Implementation**:\n1. In tui.rs when building panes, check if progress.phase != 0\n2. If true and panes not empty, add degraded indicator:\n   - Yellow/amber tint on results block border\n   - Small banner: 'âš  Indexing in progress - showing partial results'\n3. Consider showing count: 'Found X results (indexing Y% complete)'\n\n**Files to modify**:\n- src/ui/tui.rs: results pane rendering\n\n**Dependency**: Should implement after A1.1 and A1.2 for consistent styling","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.1.3","depends_on_id":"coding_agent_session_search-sux.1.1","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"},{"issue_id":"coding_agent_session_search-sux.1.3","depends_on_id":"coding_agent_session_search-sux.1.2","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.2","title":"A2: Query History Debouncing","description":"Epic for fixing query history to only save final queries, not every intermediate keystroke.","notes":"**Problem** (tui.rs:3382-3389):\nCurrently after EVERY debounced search (60ms debounce at line 3294-3296), the query is saved to history:\n```rust\nif !query.trim().is_empty()\n    && query_history.front().map(|q| q != &query).unwrap_or(true)\n{\n    query_history.push_front(query.clone());\n}\n```\n\nSo typing 'foobar' saves: 'f', 'fo', 'foo', 'foob', 'fooba', 'foobar' - 6 entries for one search!\n\n**Root Cause**:\n- Search debounce (60ms) is for responsive live search\n- History save happens after each search, not after user 'commits' query\n\n**Solution Options**:\n1. **Separate history debounce**: Save to history only after longer pause (e.g., 2-3 seconds)\n2. **Commit on Enter**: Only save when user presses Enter or navigates results\n3. **Consolidation on save**: Dedupe history on exit by removing prefixes\n4. **Hybrid**: Debounce + commit tracking\n\n**Recommended**: Option 2 (commit on explicit action) - clearest user intent","status":"open","priority":1,"issue_type":"epic","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.2","depends_on_id":"coding_agent_session_search-sux","type":"child_of","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.2.1","title":"A2.1: Remove auto-save from search execution","description":"Stop saving queries to history after every debounced search execution.","notes":"**Current Code** (tui.rs:3382-3389):\n```rust\nif !query.trim().is_empty()\n    && query_history.front().map(|q| q != &query).unwrap_or(true)\n{\n    query_history.push_front(query.clone());\n    if query_history.len() > history_cap {\n        query_history.pop_back();\n    }\n}\n```\n\n**Change**: Remove this block entirely from the search execution path.\n\n**Files to modify**:\n- src/ui/tui.rs: lines ~3382-3389\n\n**Testing**:\n- Type query, verify history NOT populated until explicit action\n- Ctrl+R should show no new entries until commit","status":"open","priority":1,"issue_type":"task","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.2.1","depends_on_id":"coding_agent_session_search-sux.2","type":"child_of","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.2.2","title":"A2.2: Save history on explicit commit actions","description":"Save query to history when user performs explicit commit actions: Enter to view, result selection, or focus change.","notes":"**Commit Actions**:\n1. **Enter key** on result â†’ save current query\n2. **Navigation to result** (selecting first result after typing) â†’ save query\n3. **Focus change** to detail pane â†’ save query\n4. **External action** (F8 editor, y copy) â†’ save query\n5. **Search refresh** (Ctrl+Shift+R) â†’ save query\n\n**Implementation**:\nCreate helper function `save_query_to_history(query, history, cap)` and call at commit points.\n\n```rust\nfn save_query_to_history(query: &str, history: &mut VecDeque<String>, cap: usize) {\n    let q = query.trim();\n    if !q.is_empty() && history.front().map(|h| h != q).unwrap_or(true) {\n        history.push_front(q.to_string());\n        if history.len() > cap {\n            history.pop_back();\n        }\n    }\n}\n```\n\n**Files to modify**:\n- src/ui/tui.rs: Add helper, call at Enter/navigation/action points\n\n**Testing**:\n- Type 'foobar', press Enter â†’ only 'foobar' in history (not f/fo/foo/etc)\n- Type query, arrow down to select â†’ query saved\n- Type query, Tab to detail â†’ query saved","status":"open","priority":1,"issue_type":"task","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.2.2","depends_on_id":"coding_agent_session_search-sux.2.1","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.2.3","title":"A2.3: History deduplication on save","description":"When persisting history to tui_state.json, deduplicate by removing queries that are strict prefixes of later queries.","notes":"**Additional Safety Net**:\nEven with commit-based saving, edge cases might save prefixes. Dedupe on persist.\n\n**Algorithm**:\n```rust\nfn dedupe_history(history: Vec<String>) -> Vec<String> {\n    let mut result = Vec::new();\n    for q in history {\n        // Skip if this is a prefix of any existing entry\n        let dominated = result.iter().any(|existing| existing.starts_with(&q) && existing != &q);\n        if !dominated {\n            // Also remove any existing entries that are prefixes of this\n            result.retain(|existing| !q.starts_with(existing) || q == *existing);\n            result.push(q);\n        }\n    }\n    result\n}\n```\n\n**Apply at** (tui.rs ~3419-3428):\n```rust\nquery_history: Some(dedupe_history(query_history.iter().cloned().collect())),\n```\n\n**Files to modify**:\n- src/ui/tui.rs: add dedupe_history function, apply in save_state\n\n**Testing**:\n- Manually add prefixes to history, verify deduped on next save","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.2.3","depends_on_id":"coding_agent_session_search-sux.2.2","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.3","title":"A3: Full Wildcard Support","description":"Epic for implementing full asterisk (*) wildcard support in search queries.","notes":"**Goal**: Support wildcards:\n- `*foo` - prefix wildcard (find 'barfoo', 'bazfoo')\n- `foo*` - suffix wildcard (find 'foobar', 'foobaz') - partially exists via prefix match mode\n- `*foo*` - both (find anything containing 'foo')\n- Explicit asterisks should override implicit behavior\n\n**Current State**:\n- Prefix match mode (F9) appends `*` to terms automatically (tui.rs:1148-1163)\n- query.rs sanitize_query() likely strips `*` as non-alphanumeric\n- Tantivy supports wildcards but may need WildcardQuery\n\n**Implementation Approach**:\n1. Preserve `*` in sanitize_query()\n2. Parse wildcards before Tantivy query construction\n3. Use appropriate Tantivy query types (WildcardQuery, PhraseQuery)\n4. Track which terms used wildcards for ranking purposes","status":"open","priority":1,"issue_type":"epic","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.3","depends_on_id":"coding_agent_session_search-sux","type":"child_of","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.3.1","title":"A3.1: Preserve asterisks in query sanitization","description":"Modify query sanitization to preserve asterisk characters as wildcard markers.","notes":"**Current** (query.rs sanitize_query - need to locate exact implementation):\nLikely strips all non-alphanumeric characters.\n\n**Change**:\n- Preserve `*` character\n- Normalize multiple asterisks: `***foo` â†’ `*foo`\n- Trim leading/trailing whitespace around asterisks\n\n**Implementation**:\n```rust\nfn sanitize_query(q: &str) -> String {\n    let mut result = String::with_capacity(q.len());\n    let mut last_was_asterisk = false;\n    for c in q.chars() {\n        if c == '*' {\n            if !last_was_asterisk {\n                result.push('*');\n            }\n            last_was_asterisk = true;\n        } else if c.is_alphanumeric() || c.is_whitespace() {\n            result.push(c);\n            last_was_asterisk = false;\n        } else {\n            result.push(' ');\n            last_was_asterisk = false;\n        }\n    }\n    result.split_whitespace().collect::<Vec<_>>().join(\" \")\n}\n```\n\n**Files to modify**:\n- src/search/query.rs: sanitize_query function\n\n**Testing**:\n- `*foo` preserved\n- `foo*bar` preserved\n- `***foo` â†’ `*foo`","status":"open","priority":1,"issue_type":"task","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.3.1","depends_on_id":"coding_agent_session_search-sux.3","type":"child_of","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.3.2","title":"A3.2: Parse wildcard patterns from query terms","description":"Create term parser that identifies wildcard patterns and returns structured term info for query building.","notes":"**Pattern Types**:\n```rust\nenum WildcardPattern {\n    Exact(String),           // no wildcards\n    Prefix(String),          // foo* - ends with asterisk\n    Suffix(String),          // *foo - starts with asterisk  \n    Contains(String),        // *foo* - both ends\n    Infix(String, String),   // foo*bar - asterisk in middle\n}\n\nfn parse_term_pattern(term: &str) -> WildcardPattern {\n    let starts = term.starts_with('*');\n    let ends = term.ends_with('*');\n    let core = term.trim_matches('*');\n    \n    match (starts, ends) {\n        (false, false) => WildcardPattern::Exact(core.to_string()),\n        (false, true) => WildcardPattern::Prefix(core.to_string()),\n        (true, false) => WildcardPattern::Suffix(core.to_string()),\n        (true, true) => WildcardPattern::Contains(core.to_string()),\n    }\n}\n```\n\n**Files to modify**:\n- src/search/query.rs: add WildcardPattern enum and parser\n\n**Testing**:\n- Unit tests for each pattern type\n- Edge cases: `*`, `**`, `*a*b*`","status":"open","priority":1,"issue_type":"task","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.3.2","depends_on_id":"coding_agent_session_search-sux.3.1","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.3.3","title":"A3.3: Build Tantivy queries from wildcard patterns","description":"Construct appropriate Tantivy query types based on parsed wildcard patterns.","notes":"**Tantivy Query Mapping**:\n- `Exact` â†’ TermQuery or edge-ngram prefix (existing behavior)\n- `Prefix` â†’ Use existing edge-ngram or PhrasePrefix\n- `Suffix` â†’ RegexQuery with `.*term$` or content_prefix ngram reversed\n- `Contains` â†’ RegexQuery with `.*term.*`\n\n**Challenge**: Tantivy doesn't have native suffix/contains. Options:\n1. RegexQuery (slow but works)\n2. Reverse-indexed field (complex schema change)\n3. Filter post-search using SQLite FTS5 (has `*term*` support)\n\n**Recommended Approach**:\n1. For `*foo*` (contains): Use FTS5 fallback which supports `*term*`\n2. For `*foo` (suffix): Same FTS5 approach\n3. For `foo*` (prefix): Use existing edge-ngram approach\n\n**Files to modify**:\n- src/search/query.rs: build_tantivy_query function\n- May need to enhance FTS5 fallback path\n\n**Testing**:\n- `foo*` returns prefix matches\n- `*foo` returns suffix matches\n- `*foo*` returns contains matches","status":"open","priority":1,"issue_type":"task","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.3.3","depends_on_id":"coding_agent_session_search-sux.3.2","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.3.4","title":"A3.4: Wildcard query tests","description":"Comprehensive tests for wildcard query functionality across all pattern types.","notes":"**Test Cases**:\n1. `foo` exact - finds 'foo' not 'foobar'\n2. `foo*` prefix - finds 'foobar', 'foobaz', not 'barfoo'\n3. `*foo` suffix - finds 'barfoo', not 'foobar'\n4. `*foo*` contains - finds 'barfoobaz', 'foobar', 'barfoo'\n5. Multiple terms: `*foo* bar*` - AND of patterns\n6. Edge cases: `*`, `**`, empty after trim\n\n**Integration Tests**:\n- Index fixture data with known patterns\n- Query with wildcards, assert correct results\n\n**Files to modify**:\n- tests/search_wildcards.rs (new)\n- Possibly update tests/util/mod.rs for fixtures\n\n**Dependency**: Needs A3.1-A3.3 complete","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.3.4","depends_on_id":"coding_agent_session_search-sux.3.3","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.4","title":"A4: Implicit Wildcards","description":"Epic for auto-adding wildcards when search results are sparse or empty.","notes":"**Goal**: When query returns zero or few results, automatically try wildcards:\n1. First try `query*` (suffix wildcard)\n2. If still sparse, try `*query*` (contains)\n3. Indicate to user that wildcards were applied\n\n**Thresholds**:\n- Zero results â†’ immediately try wildcards\n- < 3 results â†’ try wildcards for more\n- Keep explicit wildcard queries as-is\n\n**User Feedback**:\n- Footer/banner: 'Showing results for \"*query*\" (no exact matches)'\n- Option to dismiss and force exact search\n\n**Implementation Considerations**:\n- Don't apply implicit wildcards if query already has explicit `*`\n- Track whether results came from original or wildcard query for ranking\n- Cache both searches to allow quick toggle","status":"open","priority":1,"issue_type":"epic","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.4","depends_on_id":"coding_agent_session_search-sux.3","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.4.1","title":"A4.1: Detect sparse results and trigger wildcard fallback","description":"After initial search, detect when results are sparse and automatically retry with wildcards.","notes":"**Implementation in SearchClient**:\n```rust\npub struct SearchResult {\n    pub hits: Vec<SearchHit>,\n    pub original_query: String,\n    pub effective_query: String,  // may differ if wildcards applied\n    pub wildcard_fallback: bool,  // true if wildcards were auto-added\n}\n\npub fn search_with_fallback(\n    &self,\n    query: &str,\n    filters: SearchFilters,\n    limit: usize,\n    offset: usize,\n) -> Result<SearchResult> {\n    // Skip fallback if query has explicit wildcards\n    let has_explicit = query.contains('*');\n    \n    // Try original query\n    let hits = self.search(query, filters.clone(), limit, offset)?;\n    \n    if hits.len() >= 3 || has_explicit {\n        return Ok(SearchResult {\n            hits,\n            original_query: query.to_string(),\n            effective_query: query.to_string(),\n            wildcard_fallback: false,\n        });\n    }\n    \n    // Try suffix wildcard\n    let suffix_q = add_suffix_wildcards(query);\n    let suffix_hits = self.search(&suffix_q, filters.clone(), limit, offset)?;\n    \n    if suffix_hits.len() >= 3 {\n        return Ok(SearchResult { hits: suffix_hits, ..., wildcard_fallback: true });\n    }\n    \n    // Try contains wildcard\n    let contains_q = add_contains_wildcards(query);\n    let contains_hits = self.search(&contains_q, filters, limit, offset)?;\n    \n    Ok(SearchResult { hits: contains_hits, ..., wildcard_fallback: true })\n}\n```\n\n**Files to modify**:\n- src/search/query.rs: add search_with_fallback, SearchResult struct\n\n**Testing**:\n- Query with zero matches â†’ wildcards applied\n- Query with 1-2 matches â†’ wildcards tried for more\n- Query with 5+ matches â†’ no fallback","status":"open","priority":1,"issue_type":"task","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.4.1","depends_on_id":"coding_agent_session_search-sux.4","type":"child_of","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"},{"issue_id":"coding_agent_session_search-sux.4.1","depends_on_id":"coding_agent_session_search-sux.3.3","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.4.2","title":"A4.2: UI indicator for wildcard fallback","description":"Show user when implicit wildcards were applied to their search.","notes":"**UI Indicators**:\n\n1. **Status bar message**:\n   - 'Showing results for \"*query*\" (no exact matches found)'\n   - Use distinct color (info blue or muted yellow)\n\n2. **Search bar modification** (optional):\n   - Show effective query in muted text below input\n   - 'â†’ searching: *query*'\n\n3. **Hotkey to toggle**:\n   - Shift+F9 or similar to force exact search\n   - Status: 'Exact mode: no results'\n\n**Implementation in tui.rs**:\n- Track wildcard_fallback state\n- Render indicator in status or search bar area\n- Add toggle hotkey handler\n\n**Files to modify**:\n- src/ui/tui.rs: state tracking, render, hotkey\n- src/ui/components/widgets.rs: search bar enhancement\n\n**Testing**:\n- Verify indicator appears when fallback active\n- Toggle hotkey works","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.4.2","depends_on_id":"coding_agent_session_search-sux.4.1","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.5","title":"A5: Smarter Ranking","description":"Epic for improving search result ranking with recency, match quality, and configurable weighting.","notes":"**Current Ranking** (tui.rs:3321-3338):\n```rust\nlet alpha = match ranking_mode {\n    RankingMode::RecentHeavy => 1.0,\n    RankingMode::Balanced => 0.4,\n    RankingMode::RelevanceHeavy => 0.1,\n};\nlet score_a = a.score + alpha * recency(a);\n```\n\n**Problems**:\n1. Only considers Tantivy score + recency\n2. No match quality factor (exact vs wildcard)\n3. All wildcard matches treated equally\n\n**Improved Ranking Formula**:\n```\nfinal_score = tantivy_score * match_quality_factor + alpha * recency\n\nmatch_quality_factor:\n  - Exact match: 1.0\n  - Suffix wildcard only (foo*): 0.9\n  - Prefix wildcard only (*foo): 0.8\n  - Contains wildcard (*foo*): 0.7\n  - Implicit wildcard fallback: 0.6\n```\n\n**User-Configurable**:\n- F12 cycles: RecentHeavy / Balanced / RelevanceHeavy / MatchQualityHeavy","status":"open","priority":1,"issue_type":"epic","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.5","depends_on_id":"coding_agent_session_search-sux.4","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"},{"issue_id":"coding_agent_session_search-sux.5","depends_on_id":"coding_agent_session_search-sux","type":"child_of","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.5.1","title":"A5.1: Track match type in SearchHit","description":"Extend SearchHit to include information about how the result matched (exact, wildcard type, implicit fallback).","notes":"**Extend SearchHit struct**:\n```rust\npub struct SearchHit {\n    // ... existing fields ...\n    pub match_type: MatchType,\n}\n\npub enum MatchType {\n    Exact,\n    SuffixWildcard,    // foo*\n    PrefixWildcard,    // *foo\n    ContainsWildcard,  // *foo*\n    ImplicitFallback,  // auto-added wildcards\n}\n```\n\n**Set during query execution**:\n- In search_with_fallback, tag hits with appropriate MatchType\n- Track which wildcard pattern(s) matched\n\n**Files to modify**:\n- src/search/query.rs: extend SearchHit, set match_type during search\n\n**Testing**:\n- Query 'foo' returns Exact matches\n- Query 'foo*' returns SuffixWildcard matches\n- Zero-result fallback returns ImplicitFallback","status":"open","priority":1,"issue_type":"task","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.5.1","depends_on_id":"coding_agent_session_search-sux.5","type":"child_of","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"},{"issue_id":"coding_agent_session_search-sux.5.1","depends_on_id":"coding_agent_session_search-sux.4.1","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.5.2","title":"A5.2: Implement match quality factor in ranking","description":"Add match quality factor to ranking formula based on MatchType.","notes":"**Implementation in tui.rs ranking** (around line 3326-3338):\n\n```rust\nfn match_quality_factor(hit: &SearchHit) -> f32 {\n    match hit.match_type {\n        MatchType::Exact => 1.0,\n        MatchType::SuffixWildcard => 0.9,\n        MatchType::PrefixWildcard => 0.8,\n        MatchType::ContainsWildcard => 0.7,\n        MatchType::ImplicitFallback => 0.6,\n    }\n}\n\n// In ranking:\nlet quality = match_quality_factor(a);\nlet score_a = a.score * quality + alpha * recency(a);\n```\n\n**Files to modify**:\n- src/ui/tui.rs: ranking logic around line 3326\n\n**Testing**:\n- Exact match ranks above wildcard match at same recency\n- Suffix wildcard ranks above prefix wildcard\n- Implicit fallback results rank lowest","status":"open","priority":1,"issue_type":"task","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.5.2","depends_on_id":"coding_agent_session_search-sux.5.1","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.5.3","title":"A5.3: Add MatchQualityHeavy ranking mode","description":"Add new ranking mode option that prioritizes match quality over recency.","notes":"**Extend RankingMode enum**:\n```rust\nenum RankingMode {\n    RecentHeavy,\n    Balanced,\n    RelevanceHeavy,\n    MatchQualityHeavy,  // NEW\n}\n```\n\n**F12 cycle update**:\nRecentHeavy â†’ Balanced â†’ RelevanceHeavy â†’ MatchQualityHeavy â†’ RecentHeavy\n\n**Ranking formula for MatchQualityHeavy**:\n```rust\nRankingMode::MatchQualityHeavy => {\n    let quality = match_quality_factor(hit);\n    quality * 2.0 + hit.score * 0.5 + recency * 0.1\n}\n```\n\n**Files to modify**:\n- src/ui/tui.rs: RankingMode enum, F12 handler, ranking formula\n\n**Testing**:\n- F12 cycles through all 4 modes\n- MatchQualityHeavy strongly prefers exact matches","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.5.3","depends_on_id":"coding_agent_session_search-sux.5.2","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.6","title":"A6: Enhanced Result Display","description":"Epic for improving search result display: more context, highlighting, visual separation, borders, detail pane.","notes":"**Goals**:\n1. **More context**: 6-8 lines per result (currently 2)\n2. **Better highlighting**: Bold + conspicuous color for matches\n3. **Alternating stripes**: Visual separation between results\n4. **Unicode borders**: Toggleable decorative borders\n5. **Better detail pane**: More information, better layout\n6. **Other QoL**: Improved readability, information density\n\n**Current State**:\n- 2 lines per result: header (score bar + title) + location/snippet\n- Basic highlighting with accent color + bold\n- No alternating colors\n- Simple block borders\n- Detail pane has tabs but limited content visibility\n\n**Impact on Layout**:\n- More lines per result = fewer results visible\n- Need to balance context vs. scanability\n- Consider collapsible/expandable results","status":"open","priority":1,"issue_type":"epic","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.6","depends_on_id":"coding_agent_session_search-sux","type":"child_of","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.6.1","title":"A6.1: Expand result context to 6-8 lines","description":"Increase the amount of content shown per search result from 2 lines to 6-8 lines.","notes":"**Current Layout** (tui.rs:1772-1806):\n```rust\nlet header = Line::from(header_spans);  // Line 1: score + title\nlet body_line = highlight_terms_owned_with_style(  // Line 2: location + snippet\n    format!(\"{location} â€¢ {raw_snippet}\"),\n    ...\n);\nListItem::new(vec![header, body_line])\n```\n\n**New Layout (6-8 lines)**:\n```\nLine 1: [â–ˆâ–ˆâ–ˆâ–ˆ] Title (bold)\nLine 2: Agent: Claude Code | Workspace: /path/to/project\nLine 3: Source: ~/.claude/projects/xyz/session.jsonl\nLine 4: â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nLine 5: First few lines of matching content...\nLine 6: ...with search terms highlighted...\nLine 7: ...showing context around the match...\nLine 8: (optional: timestamp, tokens, etc.)\n```\n\n**Implementation**:\n1. Increase contextual_snippet size from ContextWindow to show more\n2. Split content into multiple lines\n3. Add metadata lines (agent, workspace, time)\n4. Add separator line\n\n**Files to modify**:\n- src/ui/tui.rs: ListItem construction around line 1772-1806\n- Update calculate_pane_limit() for new lines per item\n\n**Testing**:\n- Verify 6-8 lines rendered per result\n- Test with long content, short content\n- Ensure scrolling still works","status":"open","priority":1,"issue_type":"task","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.6.1","depends_on_id":"coding_agent_session_search-sux.6","type":"child_of","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.6.2","title":"A6.2: Enhanced match highlighting","description":"Improve search term highlighting with more conspicuous colors and bold styling.","notes":"**Current** (tui.rs:1166-1226):\n```rust\nspans.push(Span::styled(\n    text[start..end].to_string(),\n    base.patch(\n        Style::default()\n            .fg(palette.accent)  // Uses accent color\n            .add_modifier(Modifier::BOLD),\n    ),\n));\n```\n\n**Improvements**:\n1. **Background highlight**: Add background color for matched text\n2. **Distinct color**: Use high-contrast highlight color (e.g., yellow on dark bg)\n3. **Underline option**: Add underline for extra emphasis\n4. **Theme-aware**: Different highlight for dark/light themes\n\n**New highlight style**:\n```rust\nStyle::default()\n    .fg(palette.highlight_fg)  // High contrast text\n    .bg(palette.highlight_bg)  // Background color (e.g., dark yellow)\n    .add_modifier(Modifier::BOLD)\n```\n\n**Add to ThemePalette**:\n```rust\npub highlight_fg: Color,  // e.g., Black or dark text\npub highlight_bg: Color,  // e.g., Yellow or gold\n```\n\n**Files to modify**:\n- src/ui/components/theme.rs: add highlight colors\n- src/ui/tui.rs: update highlight_spans_owned\n\n**Testing**:\n- Verify highlights are highly visible\n- Test dark and light themes\n- Test with multiple matches in one line","status":"open","priority":1,"issue_type":"task","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.6.2","depends_on_id":"coding_agent_session_search-sux.6.1","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.6.3","title":"A6.3: Alternating color stripes for results","description":"Add alternating background colors to search results for better visual separation.","notes":"**Goal**: Zebra-striping like spreadsheets - alternating subtle background colors.\n\n**Implementation in result rendering** (tui.rs ~1772):\n```rust\nfor (idx, hit) in pane.hits.iter().enumerate() {\n    let is_odd = idx % 2 == 1;\n    let stripe_bg = if is_odd { palette.stripe_odd } else { palette.stripe_even };\n    \n    // Apply stripe_bg to all lines in this result\n    let base_style = Style::default().bg(stripe_bg);\n    // ... build lines with base_style ...\n}\n```\n\n**Add to ThemePalette**:\n```rust\npub stripe_even: Color,  // e.g., palette.bg (normal)\npub stripe_odd: Color,   // e.g., slightly lighter/darker\n```\n\n**Stripe colors**:\n- Dark theme: even=#1a1b26, odd=#1e2030\n- Light theme: even=#f0f0f5, odd=#e8e8f0\n\n**Files to modify**:\n- src/ui/components/theme.rs: add stripe colors\n- src/ui/tui.rs: apply alternating bg in result list\n\n**Testing**:\n- Verify alternating colors visible\n- Test with selected item (selection should override stripe)\n- Test both themes","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.6.3","depends_on_id":"coding_agent_session_search-sux.6.1","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.6.4","title":"A6.4: Toggleable unicode borders for results","description":"Add decorative unicode borders around individual results that can be toggled on/off.","notes":"**Goal**: Optional decorative borders for each result (not just pane border).\n\n**Unicode border characters**:\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Result content...                    â”‚\nâ”‚ More content...                      â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n**Toggle mechanism**:\n- New state: `borders_enabled: bool`\n- Hotkey: F11 or Shift+B\n- Persist in tui_state.json\n\n**Implementation**:\n```rust\nif borders_enabled {\n    // Add top border line\n    lines.push(Line::from(\"â”Œ\" + \"â”€\".repeat(width-2) + \"â”\"));\n    // Wrap content lines with â”‚ prefix/suffix\n    for line in content_lines {\n        lines.push(Line::from(format!(\"â”‚{}â”‚\", pad_to_width(line, width-2))));\n    }\n    // Add bottom border line\n    lines.push(Line::from(\"â””\" + \"â”€\".repeat(width-2) + \"â”˜\"));\n}\n```\n\n**Files to modify**:\n- src/ui/tui.rs: borders_enabled state, hotkey, render logic\n- src/ui/tui.rs: TuiStatePersisted struct, save/load\n\n**Testing**:\n- F11 toggles borders on/off\n- Borders persist across sessions\n- Layout adjusts correctly with borders","status":"open","priority":3,"issue_type":"task","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.6.4","depends_on_id":"coding_agent_session_search-sux.6.1","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.6.5","title":"A6.5: Enhanced detail pane content","description":"Improve the detail pane at the bottom to show more useful information and better layout.","notes":"**Current Detail Pane** (tui.rs:1895-2097):\n- Tabs: Messages | Snippets | Raw\n- Meta lines: Title, Agent, Workspace, Source, Score\n- Scrollable content area\n\n**Improvements**:\n\n1. **Expanded metadata section**:\n   - Add: Created timestamp, Duration, Token count\n   - Add: Match type indicator (Exact/Wildcard)\n   - Add: Quick stats (messages count, code blocks count)\n\n2. **Better messages tab**:\n   - Show message count in tab: 'Messages (42)'\n   - Add message separators with role icons\n   - Highlight search terms in message content\n   - Show timestamps for each message\n\n3. **Better snippets tab**:\n   - Group by file path\n   - Show line numbers prominently\n   - Syntax highlighting hints (language label)\n\n4. **Quick actions bar**:\n   - [c] Copy | [e] Edit | [o] Open file | [p] Print path\n   - Show in header or footer of detail pane\n\n**Files to modify**:\n- src/ui/tui.rs: detail pane rendering (~1895-2097)\n- src/ui/data.rs: potentially extend ConversationView\n\n**Testing**:\n- Verify all new metadata displays\n- Test tab switching with new content\n- Test quick actions work","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.6.5","depends_on_id":"coding_agent_session_search-sux.6.2","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.6.6","title":"A6.6: QoL improvements bundle","description":"Collection of smaller quality-of-life improvements for search results display.","notes":"**Improvements**:\n\n1. **Truncation indicators**:\n   - Show '...' when content is truncated\n   - Different from current ellipsis (use styled indicator)\n\n2. **Word wrap for long lines**:\n   - Smart word wrap instead of cut-off\n   - Indent continuation lines\n\n3. **Relative timestamps**:\n   - '2 hours ago' instead of full timestamp\n   - Already partially implemented in format_relative_time()\n\n4. **Result numbering**:\n   - Show 1-indexed result numbers for quick reference\n   - '#1', '#2', etc. in small text\n\n5. **Match count per result**:\n   - Show how many times query matches in this result\n   - '(3 matches)' indicator\n\n6. **Agent icon/emoji**:\n   - ğŸ¤– Claude | ğŸ”· Codex | ğŸ’ Gemini | etc.\n   - Quick visual identification\n\n7. **Keyboard hint for expansion**:\n   - 'Enter for details' hint on selected result\n\n**Files to modify**:\n- src/ui/tui.rs: result rendering, helpers\n- src/ui/components/theme.rs: if new styles needed\n\n**Testing**:\n- Verify each improvement individually\n- Test edge cases (very long content, many matches)","status":"open","priority":3,"issue_type":"task","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.6.6","depends_on_id":"coding_agent_session_search-sux.6.5","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.7","title":"A7: Testing and Polish","description":"Epic for comprehensive testing and final polish of all search UX improvements.","notes":"**Testing Scope**:\n\n1. **Unit tests**:\n   - Wildcard parsing\n   - Query sanitization with asterisks\n   - Match type detection\n   - Ranking formula\n   - History deduplication\n\n2. **Integration tests**:\n   - End-to-end wildcard searches\n   - Implicit wildcard fallback\n   - Ranking with mixed match types\n   - Indexing status during background indexing\n\n3. **UI/Snapshot tests**:\n   - Result display with new layout\n   - Highlighting appearance\n   - Alternating stripes\n   - Borders toggle\n   - Detail pane layout\n\n4. **Performance tests**:\n   - Wildcard query latency\n   - Fallback search overhead\n   - Rendering with more lines per result\n\n**Polish Scope**:\n- Documentation updates (README, help overlay)\n- Consistent styling across all new features\n- Error handling for edge cases\n- Accessibility considerations","status":"open","priority":2,"issue_type":"epic","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.7","depends_on_id":"coding_agent_session_search-sux.1","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"},{"issue_id":"coding_agent_session_search-sux.7","depends_on_id":"coding_agent_session_search-sux.2","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"},{"issue_id":"coding_agent_session_search-sux.7","depends_on_id":"coding_agent_session_search-sux.3","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"},{"issue_id":"coding_agent_session_search-sux.7","depends_on_id":"coding_agent_session_search-sux.4","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"},{"issue_id":"coding_agent_session_search-sux.7","depends_on_id":"coding_agent_session_search-sux.5","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"},{"issue_id":"coding_agent_session_search-sux.7","depends_on_id":"coding_agent_session_search-sux.6","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.7.1","title":"A7.1: Unit tests for wildcard and ranking","description":"Add comprehensive unit tests for wildcard parsing, match type tracking, and ranking formula.","notes":"**Test files to create/update**:\n- tests/search_wildcards.rs (new)\n- tests/ranking.rs (new)\n\n**Wildcard tests**:\n```rust\n#[test]\nfn test_sanitize_preserves_asterisks() { ... }\n\n#[test]\nfn test_parse_wildcard_patterns() {\n    assert_eq!(parse_term_pattern(\"foo\"), WildcardPattern::Exact(\"foo\"));\n    assert_eq!(parse_term_pattern(\"foo*\"), WildcardPattern::Prefix(\"foo\"));\n    assert_eq!(parse_term_pattern(\"*foo\"), WildcardPattern::Suffix(\"foo\"));\n    assert_eq!(parse_term_pattern(\"*foo*\"), WildcardPattern::Contains(\"foo\"));\n}\n\n#[test]\nfn test_normalize_multiple_asterisks() { ... }\n```\n\n**Ranking tests**:\n```rust\n#[test]\nfn test_match_quality_factor() {\n    let exact = SearchHit { match_type: MatchType::Exact, score: 1.0, ... };\n    let wildcard = SearchHit { match_type: MatchType::SuffixWildcard, score: 1.0, ... };\n    // Exact should rank higher\n}\n```\n\n**Files to create**:\n- tests/search_wildcards.rs\n- tests/ranking.rs\n\n**Dependency**: Needs A3 and A5 implementation complete","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.7.1","depends_on_id":"coding_agent_session_search-sux.3.4","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"},{"issue_id":"coding_agent_session_search-sux.7.1","depends_on_id":"coding_agent_session_search-sux.5.3","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.7.2","title":"A7.2: UI snapshot tests for new display features","description":"Add snapshot tests for the enhanced result display including highlighting, stripes, and borders.","notes":"**Use insta for snapshots** (already in deps):\n\n```rust\nuse insta::assert_snapshot;\n\n#[test]\nfn test_result_display_with_highlighting() {\n    let hit = create_test_hit(\"This is a test with foo and bar\");\n    let rendered = render_result_item(&hit, \"foo\", &palette);\n    assert_snapshot!(rendered);\n}\n\n#[test]\nfn test_alternating_stripes() { ... }\n\n#[test]\nfn test_borders_enabled() { ... }\n\n#[test]\nfn test_borders_disabled() { ... }\n```\n\n**Files to update**:\n- tests/ui_snap.rs: add new snapshot tests\n\n**Dependency**: Needs A6 display features complete","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.7.2","depends_on_id":"coding_agent_session_search-sux.6.6","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.7.3","title":"A7.3: Documentation updates","description":"Update README, help overlay, and inline comments to document all new features.","notes":"**Documentation updates**:\n\n1. **README.md**:\n   - Add section on wildcard search syntax\n   - Document implicit wildcard behavior\n   - Explain ranking modes\n   - Show new hotkeys (F11 borders, etc.)\n   - Screenshots of new result display\n\n2. **Help overlay** (tui.rs help_lines):\n   - Add Wildcards section: 'foo* prefix | *foo suffix | *foo* contains'\n   - Add Borders toggle hotkey\n   - Update display options section\n\n3. **Inline code comments**:\n   - Document WildcardPattern enum\n   - Document MatchType enum\n   - Document ranking formula\n\n4. **robot-docs update**:\n   - Include wildcard syntax in Commands topic\n   - Document new exit conditions\n\n**Files to modify**:\n- README.md\n- src/ui/tui.rs: help_lines function\n- src/search/query.rs: doc comments\n- src/lib.rs: robot-docs if needed","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.7.3","depends_on_id":"coding_agent_session_search-sux.7.1","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"},{"issue_id":"coding_agent_session_search-sux.7.3","depends_on_id":"coding_agent_session_search-sux.7.2","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.7.4","title":"A7.4: Performance validation","description":"Benchmark and validate that new features don't significantly impact search latency or rendering performance.","notes":"**Benchmarks to run/add**:\n\n1. **Wildcard query latency**:\n   - `foo*` vs `foo` (should be similar with edge-ngram)\n   - `*foo` (may be slower without reverse index)\n   - `*foo*` (may need FTS5 fallback, measure impact)\n\n2. **Fallback overhead**:\n   - Time for original + suffix + contains searches\n   - Cache hit rates with fallback\n\n3. **Rendering performance**:\n   - FPS with 6-8 lines per result vs 2 lines\n   - Stripe rendering overhead\n   - Border rendering overhead\n\n**Target budgets**:\n- Search latency: <80ms (existing target)\n- Fallback total: <150ms\n- Render FPS: 60fps (existing)\n\n**Files to update**:\n- benches/search_perf.rs: add wildcard benchmarks\n- benches/runtime_perf.rs: if needed\n\n**If performance issues found**:\n- Document in notes\n- Consider caching strategies\n- Consider async fallback","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-28T22:00:00.000000000Z","updated_at":"2025-11-28T22:00:00.000000000Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.7.4","depends_on_id":"coding_agent_session_search-sux.7.1","type":"blocks","created_at":"2025-11-28T22:00:00.000000000Z","created_by":"agent"}]}
